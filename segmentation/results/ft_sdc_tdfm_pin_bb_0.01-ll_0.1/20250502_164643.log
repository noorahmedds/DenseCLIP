2025-05-02 16:46:43,269 - mmseg - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
CUDA available: True
GPU 0: NVIDIA RTX A6000
CUDA_HOME: /usr/local/cuda-11.7
NVCC: Build cuda_11.7.r11.7/compiler.31442593_0
GCC: gcc (Ubuntu 11.4.0-1ubuntu1~22.04) 11.4.0
PyTorch: 1.8.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.7.0 (Git Hash 7aed236906b1f7a05c0917e5257a1af05e9ff683)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.8.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.9.0
OpenCV: 4.11.0
MMCV: 1.3.17
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.1
MMSegmentation: 0.19.0+47e3f65
------------------------------------------------------------

2025-05-02 16:46:43,269 - mmseg - INFO - Distributed training: False
2025-05-02 16:46:43,387 - mmseg - INFO - Config:
dataset_type = 'PartImageNet'
data_root = '/home/noah00001/Desktop/dataset/PartImageNet'
IMG_MEAN = [122.7709383, 116.7460125, 104.09373615000001]
IMG_VAR = [68.5005327, 66.6321579, 70.32316304999999]
img_norm_cfg = dict(
    mean=[122.7709383, 116.7460125, 104.09373615000001],
    std=[68.5005327, 66.6321579, 70.32316304999999],
    to_rgb=True)
crop_size = (640, 640)
model = dict(
    identity_head=dict(
        type='IdentityHead',
        in_channels=1,
        channels=1,
        num_classes=1,
        dropout_ratio=0.1,
        align_corners=False,
        ignore_index=40,
        loss_decode=dict(
            type='CrossEntropyLoss', use_sigmoid=False, loss_weight=0.4)),
    type='SimpleDenseCLIP',
    context_length=77,
    text_head=False,
    text_dim=512,
    score_concat_index=2,
    backbone=dict(
        type='CLIPVisionTransformer',
        pretrained='pretrained/ViT-B-16.pt',
        patch_size=16,
        width=768,
        output_dim=512,
        get_embeddings=True,
        drop_path_rate=0.1,
        layers=12,
        input_resolution=640,
        dense=False,
        style='pytorch'),
    text_encoder=dict(
        type='CLIPTextEncoder',
        pretrained='pretrained/ViT-B-16.pt',
        context_length=77,
        embed_dim=512,
        transformer_width=512,
        transformer_heads=8,
        transformer_layers=12,
        style='pytorch'),
    train_cfg=dict(),
    test_cfg=dict(mode='whole'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations'),
    dict(type='Resize', img_scale=(2048, 640), ratio_range=(0.5, 2.0)),
    dict(type='RandomCrop', crop_size=(640, 640), cat_max_ratio=0.75),
    dict(type='RandomFlip', prob=0.5),
    dict(type='PhotoMetricDistortion'),
    dict(
        type='Normalize',
        mean=[122.7709383, 116.7460125, 104.09373615000001],
        std=[68.5005327, 66.6321579, 70.32316304999999],
        to_rgb=True),
    dict(type='Pad', size=(640, 640), pad_val=0, seg_pad_val=255),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_semantic_seg'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2048, 640),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[122.7709383, 116.7460125, 104.09373615000001],
                std=[68.5005327, 66.6321579, 70.32316304999999],
                to_rgb=True),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=4,
    workers_per_gpu=4,
    train=dict(
        type='PartImageNet',
        data_root='/home/noah00001/Desktop/dataset/PartImageNet',
        img_dir='images/train',
        ann_dir='annotations/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations'),
            dict(type='Resize', img_scale=(2048, 640), ratio_range=(0.5, 2.0)),
            dict(type='RandomCrop', crop_size=(640, 640), cat_max_ratio=0.75),
            dict(type='RandomFlip', prob=0.5),
            dict(type='PhotoMetricDistortion'),
            dict(
                type='Normalize',
                mean=[122.7709383, 116.7460125, 104.09373615000001],
                std=[68.5005327, 66.6321579, 70.32316304999999],
                to_rgb=True),
            dict(type='Pad', size=(640, 640), pad_val=0, seg_pad_val=255),
            dict(type='DefaultFormatBundle'),
            dict(type='Collect', keys=['img', 'gt_semantic_seg'])
        ]),
    val=dict(
        type='PartImageNet',
        data_root='/home/noah00001/Desktop/dataset/PartImageNet',
        img_dir='images/val',
        ann_dir='annotations/val',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2048, 640),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[122.7709383, 116.7460125, 104.09373615000001],
                        std=[68.5005327, 66.6321579, 70.32316304999999],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='PartImageNet',
        data_root='/home/noah00001/Desktop/dataset/PartImageNet',
        img_dir='images/test',
        ann_dir='annotations/test',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2048, 640),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[122.7709383, 116.7460125, 104.09373615000001],
                        std=[68.5005327, 66.6321579, 70.32316304999999],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
log_config = dict(
    interval=50, hooks=[dict(type='TextLoggerHook', by_epoch=False)])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
cudnn_benchmark = True
find_unused_parameters = True
optimizer = dict(
    type='AdamW',
    lr=0.0001,
    weight_decay=0.0001,
    paramwise_cfg=dict(
        custom_keys=dict(
            backbone=dict(lr_mult=0.01),
            text_encoder=dict(lr_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict()
lr_config = dict(
    policy='poly',
    power=0.9,
    min_lr=1e-06,
    by_epoch=False,
    warmup='linear',
    warmup_iters=1500,
    warmup_ratio=1e-06)
runner = dict(type='IterBasedRunner', max_iters=20000)
checkpoint_config = dict(by_epoch=False, interval=2000)
evaluation = dict(interval=2000, metric='mIoU')
norm_cfg = dict(type='SyncBN', requires_grad=True)
work_dir = './results/ft_sdc_pin_last_layer'
gpu_ids = range(0, 1)

2025-05-02 16:46:43,387 - mmseg - INFO - Set random seed to 11, deterministic: False
2025-05-02 16:46:43,579 - mmseg - INFO - Loaded 20466 images
2025-05-02 16:46:45,046 - mmseg - INFO - #Params: 150699008
2025-05-02 16:46:45,790 - mmseg - INFO - SimpleDenseCLIP(
  (backbone): CLIPVisionTransformer(
    (conv1): Conv2d(3, 768, kernel_size=(16, 16), stride=(16, 16), bias=False)
    (ln_pre): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (transformer): Transformer(
      (resblocks): Sequential(
        (0): ResidualAttentionBlock(
          (attn): MultiheadAttention(
            (out_proj): _LinearWithBias(in_features=768, out_features=768, bias=True)
          )
          (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=768, out_features=3072, bias=True)
            (gelu): QuickGELU()
            (c_proj): Linear(in_features=3072, out_features=768, bias=True)
          )
          (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (drop_path): Identity()
        )
        (1): ResidualAttentionBlock(
          (attn): MultiheadAttention(
            (out_proj): _LinearWithBias(in_features=768, out_features=768, bias=True)
          )
          (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=768, out_features=3072, bias=True)
            (gelu): QuickGELU()
            (c_proj): Linear(in_features=3072, out_features=768, bias=True)
          )
          (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (drop_path): DropPath(p=0.00909090880304575)
        )
        (2): ResidualAttentionBlock(
          (attn): MultiheadAttention(
            (out_proj): _LinearWithBias(in_features=768, out_features=768, bias=True)
          )
          (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=768, out_features=3072, bias=True)
            (gelu): QuickGELU()
            (c_proj): Linear(in_features=3072, out_features=768, bias=True)
          )
          (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (drop_path): DropPath(p=0.0181818176060915)
        )
        (3): ResidualAttentionBlock(
          (attn): MultiheadAttention(
            (out_proj): _LinearWithBias(in_features=768, out_features=768, bias=True)
          )
          (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=768, out_features=3072, bias=True)
            (gelu): QuickGELU()
            (c_proj): Linear(in_features=3072, out_features=768, bias=True)
          )
          (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (drop_path): DropPath(p=0.027272727340459824)
        )
        (4): ResidualAttentionBlock(
          (attn): MultiheadAttention(
            (out_proj): _LinearWithBias(in_features=768, out_features=768, bias=True)
          )
          (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=768, out_features=3072, bias=True)
            (gelu): QuickGELU()
            (c_proj): Linear(in_features=3072, out_features=768, bias=True)
          )
          (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (drop_path): DropPath(p=0.036363635212183)
        )
        (5): ResidualAttentionBlock(
          (attn): MultiheadAttention(
            (out_proj): _LinearWithBias(in_features=768, out_features=768, bias=True)
          )
          (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=768, out_features=3072, bias=True)
            (gelu): QuickGELU()
            (c_proj): Linear(in_features=3072, out_features=768, bias=True)
          )
          (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (drop_path): DropPath(p=0.045454543083906174)
        )
        (6): ResidualAttentionBlock(
          (attn): MultiheadAttention(
            (out_proj): _LinearWithBias(in_features=768, out_features=768, bias=True)
          )
          (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=768, out_features=3072, bias=True)
            (gelu): QuickGELU()
            (c_proj): Linear(in_features=3072, out_features=768, bias=True)
          )
          (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (drop_path): DropPath(p=0.054545458406209946)
        )
        (7): ResidualAttentionBlock(
          (attn): MultiheadAttention(
            (out_proj): _LinearWithBias(in_features=768, out_features=768, bias=True)
          )
          (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=768, out_features=3072, bias=True)
            (gelu): QuickGELU()
            (c_proj): Linear(in_features=3072, out_features=768, bias=True)
          )
          (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (drop_path): DropPath(p=0.06363636255264282)
        )
        (8): ResidualAttentionBlock(
          (attn): MultiheadAttention(
            (out_proj): _LinearWithBias(in_features=768, out_features=768, bias=True)
          )
          (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=768, out_features=3072, bias=True)
            (gelu): QuickGELU()
            (c_proj): Linear(in_features=3072, out_features=768, bias=True)
          )
          (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (drop_path): DropPath(p=0.0727272778749466)
        )
        (9): ResidualAttentionBlock(
          (attn): MultiheadAttention(
            (out_proj): _LinearWithBias(in_features=768, out_features=768, bias=True)
          )
          (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=768, out_features=3072, bias=True)
            (gelu): QuickGELU()
            (c_proj): Linear(in_features=3072, out_features=768, bias=True)
          )
          (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (drop_path): DropPath(p=0.08181818574666977)
        )
        (10): ResidualAttentionBlock(
          (attn): MultiheadAttention(
            (out_proj): _LinearWithBias(in_features=768, out_features=768, bias=True)
          )
          (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=768, out_features=3072, bias=True)
            (gelu): QuickGELU()
            (c_proj): Linear(in_features=3072, out_features=768, bias=True)
          )
          (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (drop_path): DropPath(p=0.09090909361839294)
        )
        (11): ResidualAttentionBlock(
          (attn): MultiheadAttention(
            (out_proj): _LinearWithBias(in_features=768, out_features=768, bias=True)
          )
          (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=768, out_features=3072, bias=True)
            (gelu): QuickGELU()
            (c_proj): Linear(in_features=3072, out_features=768, bias=True)
          )
          (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (drop_path): DropPath(p=0.10000000149011612)
        )
      )
    )
    (ln_post): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
  )
  (text_encoder): CLIPTextEncoder(
    (transformer): Transformer(
      (resblocks): Sequential(
        (0): ResidualAttentionBlock(
          (attn): MultiheadAttention(
            (out_proj): _LinearWithBias(in_features=512, out_features=512, bias=True)
          )
          (ln_1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=512, out_features=2048, bias=True)
            (gelu): QuickGELU()
            (c_proj): Linear(in_features=2048, out_features=512, bias=True)
          )
          (ln_2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (drop_path): Identity()
        )
        (1): ResidualAttentionBlock(
          (attn): MultiheadAttention(
            (out_proj): _LinearWithBias(in_features=512, out_features=512, bias=True)
          )
          (ln_1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=512, out_features=2048, bias=True)
            (gelu): QuickGELU()
            (c_proj): Linear(in_features=2048, out_features=512, bias=True)
          )
          (ln_2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (drop_path): Identity()
        )
        (2): ResidualAttentionBlock(
          (attn): MultiheadAttention(
            (out_proj): _LinearWithBias(in_features=512, out_features=512, bias=True)
          )
          (ln_1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=512, out_features=2048, bias=True)
            (gelu): QuickGELU()
            (c_proj): Linear(in_features=2048, out_features=512, bias=True)
          )
          (ln_2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (drop_path): Identity()
        )
        (3): ResidualAttentionBlock(
          (attn): MultiheadAttention(
            (out_proj): _LinearWithBias(in_features=512, out_features=512, bias=True)
          )
          (ln_1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=512, out_features=2048, bias=True)
            (gelu): QuickGELU()
            (c_proj): Linear(in_features=2048, out_features=512, bias=True)
          )
          (ln_2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (drop_path): Identity()
        )
        (4): ResidualAttentionBlock(
          (attn): MultiheadAttention(
            (out_proj): _LinearWithBias(in_features=512, out_features=512, bias=True)
          )
          (ln_1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=512, out_features=2048, bias=True)
            (gelu): QuickGELU()
            (c_proj): Linear(in_features=2048, out_features=512, bias=True)
          )
          (ln_2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (drop_path): Identity()
        )
        (5): ResidualAttentionBlock(
          (attn): MultiheadAttention(
            (out_proj): _LinearWithBias(in_features=512, out_features=512, bias=True)
          )
          (ln_1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=512, out_features=2048, bias=True)
            (gelu): QuickGELU()
            (c_proj): Linear(in_features=2048, out_features=512, bias=True)
          )
          (ln_2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (drop_path): Identity()
        )
        (6): ResidualAttentionBlock(
          (attn): MultiheadAttention(
            (out_proj): _LinearWithBias(in_features=512, out_features=512, bias=True)
          )
          (ln_1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=512, out_features=2048, bias=True)
            (gelu): QuickGELU()
            (c_proj): Linear(in_features=2048, out_features=512, bias=True)
          )
          (ln_2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (drop_path): Identity()
        )
        (7): ResidualAttentionBlock(
          (attn): MultiheadAttention(
            (out_proj): _LinearWithBias(in_features=512, out_features=512, bias=True)
          )
          (ln_1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=512, out_features=2048, bias=True)
            (gelu): QuickGELU()
            (c_proj): Linear(in_features=2048, out_features=512, bias=True)
          )
          (ln_2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (drop_path): Identity()
        )
        (8): ResidualAttentionBlock(
          (attn): MultiheadAttention(
            (out_proj): _LinearWithBias(in_features=512, out_features=512, bias=True)
          )
          (ln_1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=512, out_features=2048, bias=True)
            (gelu): QuickGELU()
            (c_proj): Linear(in_features=2048, out_features=512, bias=True)
          )
          (ln_2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (drop_path): Identity()
        )
        (9): ResidualAttentionBlock(
          (attn): MultiheadAttention(
            (out_proj): _LinearWithBias(in_features=512, out_features=512, bias=True)
          )
          (ln_1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=512, out_features=2048, bias=True)
            (gelu): QuickGELU()
            (c_proj): Linear(in_features=2048, out_features=512, bias=True)
          )
          (ln_2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (drop_path): Identity()
        )
        (10): ResidualAttentionBlock(
          (attn): MultiheadAttention(
            (out_proj): _LinearWithBias(in_features=512, out_features=512, bias=True)
          )
          (ln_1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=512, out_features=2048, bias=True)
            (gelu): QuickGELU()
            (c_proj): Linear(in_features=2048, out_features=512, bias=True)
          )
          (ln_2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (drop_path): Identity()
        )
        (11): ResidualAttentionBlock(
          (attn): MultiheadAttention(
            (out_proj): _LinearWithBias(in_features=512, out_features=512, bias=True)
          )
          (ln_1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=512, out_features=2048, bias=True)
            (gelu): QuickGELU()
            (c_proj): Linear(in_features=2048, out_features=512, bias=True)
          )
          (ln_2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (drop_path): Identity()
        )
      )
    )
    (token_embedding): Embedding(49408, 512)
    (ln_final): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (identity_head): IdentityHead(
    input_transform=None, ignore_index=40, align_corners=False
    (loss_decode): CrossEntropyLoss()
    (conv_seg): None
    (dropout): Dropout2d(p=0.1, inplace=False)
  )
  init_cfg={'type': 'Normal', 'std': 0.01, 'override': {'name': 'conv_seg'}}
)
2025-05-02 16:46:48,009 - mmseg - INFO - Loaded 1206 images
2025-05-02 16:46:48,009 - mmseg - INFO - Start running, host: noah00001@buzz, work_dir: /home/noah00001/Desktop/projects/throwaway/DenseCLIP/segmentation/results/ft_sdc_pin_last_layer
2025-05-02 16:46:48,009 - mmseg - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) PolyLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(LOW         ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) PolyLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(LOW         ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) PolyLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(LOW         ) EvalHook                           
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(LOW         ) IterTimerHook                      
(LOW         ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(LOW         ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2025-05-02 16:46:48,009 - mmseg - INFO - workflow: [('train', 1)], max: 20000 iters
2025-05-02 16:46:48,009 - mmseg - INFO - Checkpoints will be saved to /home/noah00001/Desktop/projects/throwaway/DenseCLIP/segmentation/results/ft_sdc_pin_last_layer by HardDiskBackend.
2025-05-02 16:47:17,449 - mmseg - INFO - Iter [50/20000]	lr: 3.267e-08, eta: 3:14:29, time: 0.585, data_time: 0.011, memory: 20876, aux_identity.loss_ce: 0.4874, aux_identity.acc_seg: 3.8534, loss: 0.4874
2025-05-02 16:47:47,291 - mmseg - INFO - Iter [100/20000]	lr: 6.600e-08, eta: 3:15:58, time: 0.597, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.4942, aux_identity.acc_seg: 4.0054, loss: 0.4942
2025-05-02 16:48:16,153 - mmseg - INFO - Iter [150/20000]	lr: 9.933e-08, eta: 3:13:58, time: 0.577, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.4893, aux_identity.acc_seg: 4.2885, loss: 0.4893
2025-05-02 16:48:44,598 - mmseg - INFO - Iter [200/20000]	lr: 1.327e-07, eta: 3:12:03, time: 0.569, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.4680, aux_identity.acc_seg: 6.1397, loss: 0.4680
2025-05-02 16:49:13,874 - mmseg - INFO - Iter [250/20000]	lr: 1.660e-07, eta: 3:11:48, time: 0.586, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.4644, aux_identity.acc_seg: 8.3623, loss: 0.4644
2025-05-02 16:49:43,380 - mmseg - INFO - Iter [300/20000]	lr: 1.993e-07, eta: 3:11:43, time: 0.590, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.4610, aux_identity.acc_seg: 8.6949, loss: 0.4610
2025-05-02 16:50:11,739 - mmseg - INFO - Iter [350/20000]	lr: 2.327e-07, eta: 3:10:27, time: 0.567, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.4540, aux_identity.acc_seg: 10.7167, loss: 0.4540
2025-05-02 16:50:40,377 - mmseg - INFO - Iter [400/20000]	lr: 2.660e-07, eta: 3:09:36, time: 0.573, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.4215, aux_identity.acc_seg: 12.3733, loss: 0.4215
2025-05-02 16:51:09,364 - mmseg - INFO - Iter [450/20000]	lr: 2.993e-07, eta: 3:09:05, time: 0.580, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.4088, aux_identity.acc_seg: 10.8827, loss: 0.4088
2025-05-02 16:51:38,202 - mmseg - INFO - Iter [500/20000]	lr: 3.327e-07, eta: 3:08:29, time: 0.577, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.3719, aux_identity.acc_seg: 10.7094, loss: 0.3719
2025-05-02 16:52:07,394 - mmseg - INFO - Iter [550/20000]	lr: 3.660e-07, eta: 3:08:07, time: 0.584, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.3921, aux_identity.acc_seg: 13.6082, loss: 0.3921
2025-05-02 16:52:37,622 - mmseg - INFO - Iter [600/20000]	lr: 3.993e-07, eta: 3:08:17, time: 0.605, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.3682, aux_identity.acc_seg: 16.4877, loss: 0.3682
2025-05-02 16:53:07,768 - mmseg - INFO - Iter [650/20000]	lr: 4.327e-07, eta: 3:08:19, time: 0.603, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.3085, aux_identity.acc_seg: 10.4521, loss: 0.3085
2025-05-02 16:53:36,218 - mmseg - INFO - Iter [700/20000]	lr: 4.660e-07, eta: 3:07:29, time: 0.569, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.3228, aux_identity.acc_seg: 14.8791, loss: 0.3228
2025-05-02 16:54:04,446 - mmseg - INFO - Iter [750/20000]	lr: 4.993e-07, eta: 3:06:36, time: 0.565, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.3039, aux_identity.acc_seg: 13.5101, loss: 0.3039
2025-05-02 16:54:32,664 - mmseg - INFO - Iter [800/20000]	lr: 5.327e-07, eta: 3:05:47, time: 0.564, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.3013, aux_identity.acc_seg: 16.9628, loss: 0.3013
2025-05-02 16:55:00,948 - mmseg - INFO - Iter [850/20000]	lr: 5.660e-07, eta: 3:05:01, time: 0.566, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.2789, aux_identity.acc_seg: 15.6988, loss: 0.2789
2025-05-02 16:55:29,275 - mmseg - INFO - Iter [900/20000]	lr: 5.993e-07, eta: 3:04:18, time: 0.567, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.2885, aux_identity.acc_seg: 16.6209, loss: 0.2885
2025-05-02 16:55:57,856 - mmseg - INFO - Iter [950/20000]	lr: 6.327e-07, eta: 3:03:41, time: 0.572, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.2604, aux_identity.acc_seg: 17.0213, loss: 0.2604
2025-05-02 16:56:26,241 - mmseg - INFO - Exp name: simpledenseclip.py
2025-05-02 16:56:26,242 - mmseg - INFO - Iter [1000/20000]	lr: 6.660e-07, eta: 3:03:02, time: 0.568, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.2436, aux_identity.acc_seg: 18.6519, loss: 0.2436
2025-05-02 16:56:54,502 - mmseg - INFO - Iter [1050/20000]	lr: 6.993e-07, eta: 3:02:22, time: 0.565, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.2248, aux_identity.acc_seg: 18.0775, loss: 0.2248
2025-05-02 16:57:22,820 - mmseg - INFO - Iter [1100/20000]	lr: 7.327e-07, eta: 3:01:43, time: 0.566, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.2258, aux_identity.acc_seg: 17.9458, loss: 0.2258
2025-05-02 16:57:51,060 - mmseg - INFO - Iter [1150/20000]	lr: 7.660e-07, eta: 3:01:05, time: 0.565, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.2431, aux_identity.acc_seg: 17.9182, loss: 0.2431
2025-05-02 16:58:20,504 - mmseg - INFO - Iter [1200/20000]	lr: 7.993e-07, eta: 3:00:45, time: 0.589, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.2443, aux_identity.acc_seg: 18.2982, loss: 0.2443
2025-05-02 16:58:49,591 - mmseg - INFO - Iter [1250/20000]	lr: 8.327e-07, eta: 3:00:20, time: 0.582, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.2138, aux_identity.acc_seg: 17.2612, loss: 0.2138
2025-05-02 16:59:19,221 - mmseg - INFO - Iter [1300/20000]	lr: 8.660e-07, eta: 3:00:03, time: 0.593, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.1907, aux_identity.acc_seg: 17.8643, loss: 0.1907
2025-05-02 16:59:47,925 - mmseg - INFO - Iter [1350/20000]	lr: 8.993e-07, eta: 2:59:31, time: 0.574, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.2076, aux_identity.acc_seg: 18.2348, loss: 0.2076
2025-05-02 17:00:16,015 - mmseg - INFO - Iter [1400/20000]	lr: 9.327e-07, eta: 2:58:52, time: 0.562, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.2638, aux_identity.acc_seg: 16.6177, loss: 0.2638
2025-05-02 17:00:44,120 - mmseg - INFO - Iter [1450/20000]	lr: 9.660e-07, eta: 2:58:13, time: 0.562, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.2182, aux_identity.acc_seg: 18.0109, loss: 0.2182
2025-05-02 17:01:13,100 - mmseg - INFO - Iter [1500/20000]	lr: 9.993e-07, eta: 2:57:46, time: 0.580, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.1910, aux_identity.acc_seg: 17.6854, loss: 0.1910
2025-05-02 17:01:42,033 - mmseg - INFO - Iter [1550/20000]	lr: 1.000e-06, eta: 2:57:19, time: 0.579, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.1883, aux_identity.acc_seg: 16.7784, loss: 0.1883
2025-05-02 17:02:10,354 - mmseg - INFO - Iter [1600/20000]	lr: 1.000e-06, eta: 2:56:44, time: 0.566, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.1980, aux_identity.acc_seg: 17.0770, loss: 0.1980
2025-05-02 17:02:38,795 - mmseg - INFO - Iter [1650/20000]	lr: 1.000e-06, eta: 2:56:11, time: 0.569, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.1901, aux_identity.acc_seg: 16.8326, loss: 0.1901
2025-05-02 17:03:07,312 - mmseg - INFO - Iter [1700/20000]	lr: 1.000e-06, eta: 2:55:39, time: 0.570, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.1797, aux_identity.acc_seg: 22.0729, loss: 0.1797
2025-05-02 17:03:35,799 - mmseg - INFO - Iter [1750/20000]	lr: 1.000e-06, eta: 2:55:07, time: 0.570, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.1675, aux_identity.acc_seg: 21.2378, loss: 0.1675
2025-05-02 17:04:04,431 - mmseg - INFO - Iter [1800/20000]	lr: 1.000e-06, eta: 2:54:37, time: 0.573, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.1813, aux_identity.acc_seg: 17.7904, loss: 0.1813
2025-05-02 17:04:32,991 - mmseg - INFO - Iter [1850/20000]	lr: 1.000e-06, eta: 2:54:06, time: 0.571, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.1674, aux_identity.acc_seg: 21.3229, loss: 0.1674
2025-05-02 17:05:01,942 - mmseg - INFO - Iter [1900/20000]	lr: 1.000e-06, eta: 2:53:39, time: 0.579, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.1660, aux_identity.acc_seg: 21.4071, loss: 0.1660
2025-05-02 17:05:30,209 - mmseg - INFO - Iter [1950/20000]	lr: 1.000e-06, eta: 2:53:05, time: 0.565, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.1533, aux_identity.acc_seg: 18.5600, loss: 0.1533
2025-05-02 17:05:58,753 - mmseg - INFO - Saving checkpoint at 2000 iterations
2025-05-02 17:06:02,156 - mmseg - INFO - Exp name: simpledenseclip.py
2025-05-02 17:06:02,156 - mmseg - INFO - Iter [2000/20000]	lr: 1.000e-06, eta: 2:53:05, time: 0.639, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.1876, aux_identity.acc_seg: 20.6276, loss: 0.1876
2025-05-02 17:07:30,194 - mmseg - INFO - per class results:
2025-05-02 17:07:30,195 - mmseg - INFO - 
+------------------+-------+-------+
|      Class       |  IoU  |  Acc  |
+------------------+-------+-------+
|  Quadruped Head  | 54.64 |  73.9 |
|  Quadruped Body  | 40.88 | 64.92 |
|  Quadruped Foot  |  1.89 |  1.89 |
|  Quadruped Tail  |  0.0  |  0.0  |
|    Biped Head    | 48.37 | 77.36 |
|    Biped Body    | 15.75 | 24.01 |
|    Biped Hand    | 14.91 | 33.46 |
|    Biped Foot    |  0.0  |  0.0  |
|    Biped Tail    |  0.0  |  0.0  |
|    Fish Head     | 33.96 | 37.42 |
|    Fish Body     | 42.93 | 83.86 |
|     Fish Fin     |  0.0  |  0.0  |
|    Fish Tail     |  0.0  |  0.0  |
|    Bird Head     | 14.69 | 14.83 |
|    Bird Body     | 47.18 |  91.1 |
|    Bird Wing     | 19.78 | 22.33 |
|    Bird Foot     |  0.0  |  0.0  |
|    Bird Tail     |  0.0  |  0.0  |
|    Snake Head    |  0.01 |  0.01 |
|    Snake Body    | 79.85 | 99.72 |
|   Reptile Head   | 29.98 | 41.53 |
|   Reptile Body   | 48.78 | 84.58 |
|   Reptile Foot   |  0.0  |  0.0  |
|   Reptile Tail   |  0.0  |  0.0  |
|     Car Body     | 88.52 | 99.97 |
|     Car Tire     |  0.0  |  0.0  |
| Car Side Mirror  |  0.0  |  0.0  |
|   Bicycle Body   | 28.34 | 55.34 |
|   Bicycle Head   |  0.0  |  0.0  |
|   Bicycle Seat   |  0.0  |  0.0  |
|   Bicycle Tire   | 24.13 | 28.03 |
|    Boat Body     |  4.37 |  4.53 |
|    Boat Sail     | 65.04 | 99.43 |
|  Aeroplane Head  |  0.0  |  0.0  |
|  Aeroplane Body  | 49.32 | 100.0 |
| Aeroplane Engine |  0.0  |  0.0  |
|  Aeroplane Wing  |  0.0  |  0.0  |
|  Aeroplane Tail  |  0.0  |  0.0  |
|   Bottle Mouth   |  0.0  |  0.0  |
|   Bottle Body    | 89.65 | 99.52 |
+------------------+-------+-------+
2025-05-02 17:07:30,196 - mmseg - INFO - Summary:
2025-05-02 17:07:30,196 - mmseg - INFO - 
+-------+-------+-------+
|  aAcc |  mIoU |  mAcc |
+-------+-------+-------+
| 64.87 | 21.07 | 30.94 |
+-------+-------+-------+
2025-05-02 17:07:30,205 - mmseg - INFO - Exp name: simpledenseclip.py
2025-05-02 17:07:30,205 - mmseg - INFO - Iter(val) [1206]	aAcc: 0.6487, mIoU: 0.2107, mAcc: 0.3094, IoU.Quadruped Head: 0.5464, IoU.Quadruped Body: 0.4088, IoU.Quadruped Foot: 0.0189, IoU.Quadruped Tail: 0.0000, IoU.Biped Head: 0.4837, IoU.Biped Body: 0.1575, IoU.Biped Hand: 0.1491, IoU.Biped Foot: 0.0000, IoU.Biped Tail: 0.0000, IoU.Fish Head: 0.3396, IoU.Fish Body: 0.4293, IoU.Fish Fin: 0.0000, IoU.Fish Tail: 0.0000, IoU.Bird Head: 0.1469, IoU.Bird Body: 0.4718, IoU.Bird Wing: 0.1978, IoU.Bird Foot: 0.0000, IoU.Bird Tail: 0.0000, IoU.Snake Head: 0.0001, IoU.Snake Body: 0.7985, IoU.Reptile Head: 0.2998, IoU.Reptile Body: 0.4878, IoU.Reptile Foot: 0.0000, IoU.Reptile Tail: 0.0000, IoU.Car Body: 0.8852, IoU.Car Tire: 0.0000, IoU.Car Side Mirror: 0.0000, IoU.Bicycle Body: 0.2834, IoU.Bicycle Head: 0.0000, IoU.Bicycle Seat: 0.0000, IoU.Bicycle Tire: 0.2413, IoU.Boat Body: 0.0437, IoU.Boat Sail: 0.6504, IoU.Aeroplane Head: 0.0000, IoU.Aeroplane Body: 0.4932, IoU.Aeroplane Engine: 0.0000, IoU.Aeroplane Wing: 0.0000, IoU.Aeroplane Tail: 0.0000, IoU.Bottle Mouth: 0.0000, IoU.Bottle Body: 0.8965, Acc.Quadruped Head: 0.7390, Acc.Quadruped Body: 0.6492, Acc.Quadruped Foot: 0.0189, Acc.Quadruped Tail: 0.0000, Acc.Biped Head: 0.7736, Acc.Biped Body: 0.2401, Acc.Biped Hand: 0.3346, Acc.Biped Foot: 0.0000, Acc.Biped Tail: 0.0000, Acc.Fish Head: 0.3742, Acc.Fish Body: 0.8386, Acc.Fish Fin: 0.0000, Acc.Fish Tail: 0.0000, Acc.Bird Head: 0.1483, Acc.Bird Body: 0.9110, Acc.Bird Wing: 0.2233, Acc.Bird Foot: 0.0000, Acc.Bird Tail: 0.0000, Acc.Snake Head: 0.0001, Acc.Snake Body: 0.9972, Acc.Reptile Head: 0.4153, Acc.Reptile Body: 0.8458, Acc.Reptile Foot: 0.0000, Acc.Reptile Tail: 0.0000, Acc.Car Body: 0.9997, Acc.Car Tire: 0.0000, Acc.Car Side Mirror: 0.0000, Acc.Bicycle Body: 0.5534, Acc.Bicycle Head: 0.0000, Acc.Bicycle Seat: 0.0000, Acc.Bicycle Tire: 0.2803, Acc.Boat Body: 0.0453, Acc.Boat Sail: 0.9943, Acc.Aeroplane Head: 0.0000, Acc.Aeroplane Body: 1.0000, Acc.Aeroplane Engine: 0.0000, Acc.Aeroplane Wing: 0.0000, Acc.Aeroplane Tail: 0.0000, Acc.Bottle Mouth: 0.0000, Acc.Bottle Body: 0.9952
2025-05-02 17:07:59,137 - mmseg - INFO - Iter [2050/20000]	lr: 1.000e-06, eta: 3:05:28, time: 2.339, data_time: 1.767, memory: 20876, aux_identity.loss_ce: 0.1633, aux_identity.acc_seg: 21.1404, loss: 0.1633
2025-05-02 17:08:28,022 - mmseg - INFO - Iter [2100/20000]	lr: 1.000e-06, eta: 3:04:39, time: 0.578, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.1620, aux_identity.acc_seg: 20.9832, loss: 0.1620
2025-05-02 17:08:57,411 - mmseg - INFO - Iter [2150/20000]	lr: 1.000e-06, eta: 3:03:55, time: 0.588, data_time: 0.007, memory: 20876, aux_identity.loss_ce: 0.1692, aux_identity.acc_seg: 22.1437, loss: 0.1692
